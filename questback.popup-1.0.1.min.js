var questback=questback||{};questback.popup=new function(){function e(e,t){F[e]||(F[e]=t)}function t(t,i,n,o,r){var d=r?"":" ",l="";o&&(l=a(t,"theme",o)),null!=l&&void 0!==l||(l="");var s="."+L+".qb-popup-"+t.index+d+i.replace(/\./g,"."+t.cssPrefix);o&&e(o,s),S.push(s+"{"+n+l+"}")}function i(e,t){var i="",n="";for(var o in F)u(i=a(e,"theme",o+t))||(n=F[o],S.push(n+"{"+i+"}"))}function n(e,t,i){for(var n=["@-webkit-keyframes","@-moz-keyframes","@-o-keyframes","@keyframes"],o=0;o<n.length;o++){var a=n[o];S.push(a+" "+L+"-"+e.index+"-"+e.cssPrefix+t+" {"+i+"}")}}function o(e,i,n,o){for(var r=["-webkit-animation-name","-moz-animation-name","-o-animation-name","animation-name"],d=new Array,l=0;l<r.length;l++){var s=r[l];d.push(s+": "+L+"-"+e.index+"-"+e.cssPrefix+n+";")}d.push("-webkit-animation-fill-mode: both;-moz-animation-fill-mode: both;-ms-animation-fill-mode: both;-o-animation-fill-mode: both;animation-fill-mode: both;-webkit-animation-duration:"+o+"ms;-moz-animation-duration:"+o+"ms;-ms-animation-duration:"+o+"ms;-o-animation-duration:"+o+"ms;animation-duration: "+o+"ms;"),t(e,i,d.join("")+a(e,"theme","stateDisplayed"))}function a(e){var t="",i=!1;t=e;for(var n=1;n<arguments.length;n++)if(void 0===(t=t[arguments[n]])){i=!0;break}return i?"":t}function r(e,t){var i=a(e,"theme",t),n=500;return i&&null==(n=a(e,"theme",t,"duration"))&&(n="none"==i.type?0:500),n}function d(){var e=document.body,t=document.documentElement;return Math.max(e.scrollHeight,e.offsetHeight,t.clientHeight,t.scrollHeight,t.offsetHeight)}function l(){var e=document.body,t=document.documentElement;return Math.max(e.scrollWidth,e.offsetWidth,t.clientWidth,t.scrollWidth,t.offsetWidth)}function s(){return void 0===window.pageYOffset?Math.max(document.documentElement.scrollTop,document.body.scrollTop):window.pageYOffset}function c(){return void 0===window.pageXOffset?Math.max(document.documentElement.scrollLeft,document.body.scrollLeft):window.pageXOffset}function p(e,t){var i=a(e,"theme",t);if(i){if("none"==i.type)return"";if("fade-in"==i.type)return"0% {opacity: 0;} 100% {opacity: 1;}";if("fade-out"==i.type)return"0% {opacity: 1;} 100% {opacity: 0;}";if("rotate-in"==i.type)return"0% {opacity: 0;transform: rotate(360deg) scale(0);} 100% {opacity: 1;transform: rotate(0deg) scale(1);}";if("slide-from-left"==i.type)return"0% {opacity: 0;transform: translateX(-50%);} 50%{opacity: 1;} 100% {opacity: 1;transform: translateX(0);}";if("slide-from-right"==i.type)return"0% {opacity: 0;transform: translateX(50%);} 50%{opacity: 1;} 100% {opacity: 1;transform: translateX(0);}";if("slide-from-top"==i.type)return"0% {opacity: 0;transform: translateY(-50%);} 50%{opacity: 1;} 100% {opacity: 1;transform: translateY(0);}";if("slide-from-bottom"==i.type)return"0% {opacity: 0;transform: translateY(50%);} 50%{opacity: 1;} 100% {opacity: 1;transform: translateY(0);}";if("scale-in"==i.type)return"0% {opacity: 0;transform: scale(0);} 100% {opacity: 1;transform: scale(1);}";if("rotate-out"==i.type)return"0% {opacity: 1;transform: rotate(0deg) scale(1);} 100% {opacity: 0;transform: rotate(360deg) scale(0);}";if("scale-out"==i.type)return"0% {opacity: 1;transform:scale(1);} 100% {opacity: 0;transform: scale(0);}";if("slide-to-left"==i.type)return"0% {opacity: 1;transform: translateX(0);} 50% {opacity: 0;} 100% {opacity: 0;transform: translateX(-50%);}";if("slide-to-right"==i.type)return"0% {opacity: 1;transform: translateX(0);} 50% {opacity: 0;} 100% {opacity: 0;transform: translateX(50%);}";if("slide-to-top"==i.type)return"0% {opacity: 1;transform: translateY(0);} 50% {opacity: 0;} 100% {opacity: 0;transform: translateY(-50%);}";if("slide-to-bottom"==i.type)return"0% {opacity: 1;transform: translateY(0);} 50% {opacity: 0;} 100% {opacity: 0;transform: translateY(50%);}";if("custom"==i.type)return a(e,"theme",t,"css")}return"0% {opacity: 0;} 100% {opacity: 1;}"}function m(e){(S=new Array).push(".questback *{box-sizing:border-box;}"),e.theme.backdrop&&t(e,".backdrop","background-color:#404040;background:rgba(0,0,0,0.3);position:absolute;top:0;left:0;bottom:0;right:0;display:none;z-index:100000;","backdrop"),t(e,".content","padding:30px 50px;margin:0;width:auto;height:auto;border:none;background:#f5f5f5;","content"),t(e,".content-embedded","margin:0;border:none;margin-left:auto;margin-right:auto;contentEmbedded"),t(e,".wrapper","z-index:100001;font-size:14px;display:none;border:none;"+(e.theme.shadow?"box-shadow:5px 5px 20px rgba(0,0,0,0.2);":"")+"font-family:Helvetica,​Arial,​sans-serif;background:#ffffff;position:absolute;max-width:100%;left:-10000px;top:-10000px;padding:10px;position:absolute;","wrapper"),t(e,".state-embedded-display","-webkit-transition: all 0.5s;transition: all 0.5s;"),t(e,".wrapper-bar","text-align:right;font-size:1.75em;padding:0 5px 5px 0;","wrapperBar"),t(e,".survey-frame","border:none;width:100%;height:100%;","surveyFrame"),t(e,".close-button","cursor:pointer;line-height:1em;text-decoration:none;background:none;","closeButton"),t(e,".close-button:hover","cursor:pointer;line-height:1em;text-decoration:none;background:none;","closeButtonHover"),t(e,".heading","font-size:4em;word-wrap: break-word;font-weight:normal;margin:0 0 0.5em 0;","heading");t(e,".logo-container","middle"==e.theme.logo.vAlign?"left"==e.theme.logo.align?"float:left;margin-right:1em;":"float:right;margin-left:1em;":"text-align:"+e.theme.logo.align,"logoContainer"),t(e,".logo","max-width:100%;","logo"),t(e,".text","font-size:1em;font-weight:normal;","text"),t(e,".buttons","margin-top:20px;text-align:"+e.theme.buttonAlignment+";","buttons"),t(e,".button","transition: all 0.25s;font-family:inherit;text-align:center;font-size:14px;min-width:150px;background:#e0e0e0;margin:5px;padding:0px 10px;line-height:48px;border:none;cursor:pointer;","button"),t(e,".button:hover","filter: brightness(105%);","buttonHover"),t(e,".participate","background:#1acd72;transition: all 0.25s;color:#000000;","participate"),t(e,".participate:hover","","participateHover"),t(e,".decline","","decline"),t(e,".decline:hover","","declineHover"),t(e,".other","","other"),t(e,".other:hover","","otherHover"),n(e,"show-animation",p(e,"showAnimation")),n(e,"hide-animation",p(e,"hideAnimation"));var d=a(e,"theme","showAnimation","type"),l=r(e,"showAnimation");"none"!=d&&o(e,".state-displayed","show-animation",l);var s=a(e,"theme","hideAnimation","type"),c=r(e,"hideAnimation");"none"!=s&&o(e,".state-hidden","hide-animation",c),S.push("@media (max-width: "+D+"px) { "),i(e,"MD"),S.push("}"),S.push("@media (max-width: "+O+"px) { "),i(e,"SM"),S.push("}"),i(e,"XS"),S.push("@media (max-width: "+B+"px) { "),t(e,".content","padding:10px 10px;"),t(e,".heading","font-size:2.5em;"),i(e,"XS"),S.push("}");var m="";if("string"==typeof e.theme.imports)m="@import url('"+e.theme.imports+"');";else if(e.theme.imports instanceof Array)for(var h=e.theme.imports.length,u=0;u<h;u++)m+="@import url('"+e.theme.imports[u]+"');";var f=m+S.join("\n")+a(e,"theme","customCSS");if(void 0===document.createStyleSheet){var y=document.createElement("style");y.type="text/css",y.appendChild(document.createTextNode(f));try{(document.head||document.getElementsByTagName("head")[0]).appendChild(y)}catch(e){0==document.body.childNodes.length?document.body.appendChild(y):document.body.insertBefore(y,document.body.childNodes[0])}}else document.createStyleSheet("").cssText=f}function h(e){if(null===e||"object"!=typeof e)return e;var t=e.constructor();for(var i in e)t[i]=h(e[i]);return t}function u(e){return!("string"==typeof e&&e.length>0)}function f(e,t,i){e.addEventListener?e.addEventListener(t,i,!1):e.attachEvent&&e.attachEvent("on"+t,i)}function y(e){if(void 0===e.identifier){var t=null;if(e.buttons)for(var i=0;i<e.buttons.length;i++){var n=e.buttons[i];if("participate"==n.type&&n.url){t=n.url;break}}var o=e.index;if(t){var a=t.replace(/[^\w]/g,"");a?o=a:console.log("Warning: Unable to create identifier from url. Please explicitly set identifier to a unique identifier (string) for the survey in the config.")}e.identifier="qb"+o}if(null==e.cssPrefix&&(e.cssPrefix="qb-"),void 0===e.display&&(e.display={type:"tab"}),"window"!=e.display.type&&"embedded"!=e.display.type||(void 0===e.display.width&&(e.display.width=800),void 0===e.display.height&&(e.display.height=600)),void 0===e.redisplayAfterDays&&(e.redisplayAfterDays=365),void 0===e.cookieName&&(e.cookieName="questback.popup."+e.identifier),void 0===e.displayFraction&&(e.displayFraction=1),"embedded"==e.display.type?e.closeButton||(e.closeButton=!0):"window"==e.display.type&&(void 0===e.display.width&&(width=Math.min(800,screen.width)),void 0===e.display.height&&(e.type.height=Math.min(600,screen.height))),void 0===e.width&&(e.width=500),void 0===e.left&&(e.left="50%"),void 0===e.top&&(e.top="50%"),null!=X&&void 0!==e.theme){var r=h(e.theme);e.theme=h(X);for(var d in r)e.theme[d]=r[d]}void 0===e.theme&&(e.theme=null!=X?h(X):{}),void 0===e.theme.shadow&&(e.theme.shadow=!0),void 0===e.theme.showAnimation&&(e.theme.showAnimation={}),void 0===e.theme.showAnimation.type&&(e.theme.showAnimation.type="fade-in"),void 0===e.theme.showAnimation.duration&&(e.theme.showAnimation.duration="none"==e.theme.showAnimation.type?0:500),void 0===e.theme.hideAnimation&&(e.theme.hideAnimation={}),void 0===e.theme.hideAnimation.type&&(e.theme.hideAnimation.type="fade-out"),void 0===e.theme.hideAnimation.duration&&(e.theme.hideAnimation.duration="none"==e.theme.hideAnimation.type?0:500),void 0===e.theme.buttonAlignment&&(e.theme.buttonAlignment="center"),void 0===e.theme.logo&&(e.theme.logo={}),void 0===e.theme.logo.align&&(e.theme.logo.align="left"),void 0===e.theme.logo.vAlign&&(e.theme.logo.vAlign="top")}function g(e,t){return x(t).cssPrefix+e}function v(){return window.devicePixelRatio>1||window.matchMedia&&window.matchMedia("(-webkit-min-device-pixel-ratio: 1.5),(-moz-min-device-pixel-ratio: 1.5),(min-device-pixel-ratio: 1.5)").matches}function b(e){var t=document.createElement("div");if(t.className="questback qb-popup-"+e.index+" "+g("container",e.index),e.theme.backdrop){var i=document.createElement("div");i.className=g("backdrop",e.index),t.appendChild(i)}var n=document.createElement("div");if(n.className=g("wrapper",e.index),t.appendChild(n),e.closeButton){var o=document.createElement("div");o.className=g("wrapper-bar",e.index);var a=document.createElement("a");a.className=g("close-button",e.index),e.closeButton.text?a.innerHTML=e.closeButton.text:a.innerHTML="&times",f(a,"click",function(){return questback.popup.hide(e.index),!1}),o.appendChild(a),n.appendChild(o)}var r=document.createElement("div");r.className=g("content",e.index),n.appendChild(r);var d=null;if(e.theme.logo.url){(d=document.createElement("div")).className=g("logo-container",e.index);var l=document.createElement("img");l.className=g("logo",e.index),l.src=e.theme.logo.url,d.appendChild(l)}null==d||"top"!=e.theme.logo.vAlign&&"middle"!=e.theme.logo.vAlign||r.appendChild(d);var s=document.createElement("div");s.className=g("heading",e.index),s.innerHTML=e.title,r.appendChild(s),null!=d&&"bottom"==e.theme.logo.vAlign&&r.appendChild(d);var c=document.createElement("div");c.className=g("text",e.index),c.innerHTML=e.text,r.appendChild(c);var p=document.createElement("div");p.className=g("buttons",e.index);var m=new Array;if(e.buttons)for(var h=0;h<e.buttons.length;h++){var u=e.buttons[h];m.push("<button class='"+g("button",e.index)+" "+g(u.type,e.index)+"' onclick='return questback.popup.handleButtonClick(event,"+e.index+","+h+");'>"+u.text+"</button>")}return p.innerHTML=m.join(""),r.appendChild(p),t}function x(e){return void 0===e&&(e=0),(e<0||e>=P.length)&&(console.log("Error: Could not find index "+e+", default to last entry."),e=P.length-1),P[e]}function w(e){return x(e).container}function k(e){var t=x(e);return t.theme.backdrop?t.container.childNodes[1]:t.container.childNodes[0]}function A(e){var t=x(e);return t.theme.backdrop?t.container.childNodes[0]:null}function N(e){for(var t=k(e).childNodes,i=0;i<t.length;i++)if(-1!=(t[i].className+"").indexOf("content"))return t[i]}function E(e,t){var i=void 0!=window.screenLeft?window.screenLeft:screen.left,n=void 0!=window.screenTop?window.screenTop:screen.top;width=window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width,height=window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height;var o=e.display.width?e.display.width:width,a=e.display.height?e.display.height:height;"string"==typeof o&&(o=-1!=o.indexOf("%")?width*parseFloat(o.replace("%",""))/100:parseInt(o.replace("px",""))),"string"==typeof a&&(a=-1!=a.indexOf("%")?height*parseFloat(a.replace("%",""))/100:parseInt(a.replace("px",""))),o=Math.min(width,o),a=Math.min(height,a);var r=width/2-o/2+i,d=height/2-a/2+n,l=window.open(t,"_blank","menubar=0, resizable=1, scrollbars=1, toolbar=0, width="+o+", height="+a+", top="+d+", left="+r);window.focus&&l.focus()}function M(e,t,i){if(i){var n=new Date;n.setTime(n.getTime()+24*i*60*60*1e3);o="; expires="+n.toGMTString()}else var o="";document.cookie=e+"="+t+o+"; path=/"}function H(e){for(var t=e+"=",i=document.cookie.split(";"),n=0;n<i.length;n++){for(var o=i[n];" "==o.charAt(0);)o=o.substring(1,o.length);if(0==o.indexOf(t))return o.substring(t.length,o.length)}return null}function C(e){return!e.disableCookies&&("displayed"==H(e.cookieName+".s")||"displayed"==H(e.cookieName+".p"))}function q(e){if(e.frame)try{if(e.frame.contentWindow.location.href){var t=e.frame.contentWindow.location.href;if("about:blank"!=t&&""!=t)return void questback.popup.hide(e.index)}setTimeout(function(){q(e)},100)}catch(t){setTimeout(function(){q(e)},100)}}function T(e){e.disableCookies||(M(e.cookieName+".s","displayed"),e.redisplayAfterDays>0&&M(e.cookieName+".p","displayed",e.redisplayAfterDays))}function W(e,t){var i=k(e.index),n=N(e.index),o=n.clientWidth,a=n.clientHeight,r=i.clientWidth,d=i.clientHeight;i.style.height=d+"px",i.className+=" "+g("state-embedded-display",e.index),n.innerHTML="",e.frame=document.createElement("iframe"),e.frame.className=g("survey-frame",e.index);var l=document.documentElement.clientWidth||document.body.clientWidth,p=document.documentElement.clientHeight||document.body.clientHeight,m=e.display.width?e.display.width:r,h=e.display.height?e.display.height:d;"string"==typeof h&&(h=-1!=h.indexOf("%")?p*parseFloat(h.replace("%",""))/100:parseInt(h.replace("px",""))),"string"==typeof m&&(m=-1!=m.indexOf("%")?l*parseFloat(m.replace("%",""))/100:parseInt(m.replace("px",""))),v()?(l<p&&l<=640||l>p&&l<=960)&&(m=l,h=p):(l<p&&l<=320||l>p&&l<=480)&&(m=l,h=p);var u=r+m-o,f=d+h-a;u>l&&(m-=u-l,u=l),f>p&&(h-=f-p,f=p);var y=e.position.x,b=e.position.y;u>r&&(y-=Math.round(u-r)/2),f>d&&(b-=Math.round(f-d)/2),y=c()+Math.max(Math.min(y,l-u),0),b=s()+Math.max(Math.min(b,p-f),0),i.style.left=y+"px",i.style.top=b+"px",e.position.x=y,e.position.y=b,n.className=g("content-embedded",e.index),n.style.width=m+"px",n.style.height=h+"px",n.appendChild(e.frame),i.style.width=u+"px",i.style.height=f+"px",setTimeout(function(){e.frame.src=t,setTimeout(function(){q(e)},1e3)},500)}function z(e){e.containerAdded&&(document.body.removeChild(e.container),e.containerAdded=!1,e.container=null),e.state=null}var B=767,O=991,D=1199,L="questback",P=new Array,S=new Array,X=null,F=new Object;return{init:function(e){if(!e.initiated){y(e),m(e);var t=b(e);e.container=t,e.initiated=!0}return e.container},setTheme:function(e){X=e},participate:function(e){void 0===e&&(e=0);var t=x(e);z(t);var i=b(t);if(t.container=i,!t.state||"participate"!==t.state){for(var n=-1,o=0;o<t.buttons.length;o++)if("participate"===t.buttons[o].type){n=o;break}"embedded"==t.display.type?questback.popup.show(e,!0,function(){n>=0&&questback.popup.handleButtonClick(null,e,n)}):n>=0&&questback.popup.handleButtonClick(null,e,n)}},invite:function(e){void 0===e&&(e=0);var t=x(e);z(t),t.state&&"invite"===t.state||questback.popup.show(e,!0)},handleButtonClick:function(e,t,i){var n=x(t);if(n.buttons){var o=n.buttons[i];if("decline"===o.type)questback.popup.hide(n.index);else if("participate"===o.type&&(n.state="participate",n.display)){if("embedded"==n.display.type)return void W(n,o.url);if("window"==n.display.type)return E(n,o.url),void questback.popup.hide(n.index);if("tab"==n.display.type)return window.open(o.url,"_blank"),void questback.popup.hide(n.index);if("onleave"==n.display.type)return window.open("about:blank","_blank").document.write("test"),void questback.popup.hide(n.index)}u(o.url)||window.open(o.url),o.callback&&(e&&(e.config=o),o.callback(e,w(n.index)))}},hide:function(e){var t=x(e),i=t.container,n=(N(e),k(e));n.className=n.className.replace(g("state-displayed",e),""),n.className+=" "+g("state-hidden",e);var o=r(x(e),"hideAnimation");i&&(0==o?z(t):setTimeout(function(){z(t)},o))},hideAll:function(e){for(var t=0;t<P.length;t++)z(P[t])},show:function(e,t,i){var n=x(e);if(!n.state||"invite"!==n.state){var o=!1;if(Math.random()<=1*n.displayFraction){o=!0;var a=new Date;if(void 0!==n.activePeriodStart&&(o=a>=n.activePeriodStart),void 0!==n.activePeriodEnd){var r=new Date(n.activePeriodEnd);r.setDate(r.getDate()+1),o=a<r}o=!C(n)}if(o||t){n.containerAdded||(n.container||(n.container=b(n)),document.body.appendChild(n.container),n.containerAdded=!0),t||T(n);var p=w(e),m=k(e),h=A(e);if(p&&(p.style.display="block"),h&&(h.style.display="block",h.style.width=l()+"px",h.style.height=d()+"px"),m){m.style.display="block",n.state="invite";var u,f,y=document.documentElement.clientWidth||document.body.clientWidth,v=document.documentElement.clientHeight||document.body.clientHeight,N=n.width;m.style.width="string"==typeof N?N:N+"px",void 0!==n.height&&("string"==typeof n.height?m.style.height=n.height:m.style.height=n.height+"px");var E=function(){m.className=m.className.replace(g("state-hidden",e),""),m.className+=" "+g("state-displayed",e),f="string"==typeof n.top?-1!=n.top.indexOf("%")?v*parseFloat(n.top.replace("%",""))/100:parseInt(n.top.replace("px","")):n.top,u="string"==typeof n.left?-1!=n.left.indexOf("%")?y*parseFloat(n.left.replace("%",""))/100:parseInt(n.left.replace("px","")):n.left,u=c()+Math.max(Math.min(u-Math.round(m.clientWidth/2),y-m.clientWidth),0),f=s()+Math.max(Math.min(f-Math.round(m.clientHeight/2),v-m.clientHeight),0),m.style.top=f+"px",m.style.left=u+"px",n.position={},n.position.x=u,n.position.y=f,i&&i()};"none"==n.theme.showAnimation.type?E():setTimeout(E,n.theme.showAnimation.duration+100)}}}},standardConfig:function(e,t,i,n,o){return{title:e,text:t,buttons:[{type:"participate",text:n,url:i},{type:"decline",text:o}]}},create:function(e,t,i){var n,o,a;if("string"==typeof e?(o=e,n=t,a=i):(n=e,a=t),void 0!==a&&(t.theme=a),o&&n.buttons)for(var r=0;r<n.buttons.length;r++){var d=n.buttons[r];"participate"==d.type&&(d.url||(d.url=o))}if(n.index=P.length,P.push(n),questback.popup.init(n),!1!==n.autoDisplay){var l=n.delay>0?1e3*n.delay:500;setTimeout(function(){questback.popup.show(n.index)},l)}}}};